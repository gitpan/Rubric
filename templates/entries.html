	[% IF user %]
	[% PROCESS "user_tags.html" %]
	[% END %]

	[% IF user && tags.size %]
	<div class='taglist related'>
	<h3>related tags</h3>
	[% FOREACH tag = user.related_tags_counted(tags) %]
	<div class='tag'>
	<span class='tag_count'>[% tag.1 %]</span>
	&nbsp;
	<a class='plus' href='[% uri.entries(user => user, tags => tags.merge( [ tag.0 ] )) %]'>+</a>
	<a href='[% uri.entries(user => user, tags => [ tag.0 ] ) %]'>[% tag.0 %]</a>
	&nbsp;
	</div>
	[% END %]
	<br />
	[% FOREACH tag = tags %]
	<div class='tag'>
	<span class='tag_count'>&nbsp;</span>
	&nbsp;
	<a class='plus' href='[% uri.entries(user => user, tags => remove(tag, tags)) %]'>-</a>
	<a href='[% uri.entries(user => user, tags => [ tag ] ) %]'>[% tag %]</a>
	&nbsp;</div>
	[% END %]
	</div>
	[% END %]

	[% IF recent_tags.size %]
	<div class='taglist recent'>
	<h3>recent tags</h3>
	[% FOREACH tag = recent_tags %]
	<div class='tag'>
		<span class='tag_count'>[% tag.1 %]</span>
		&nbsp;
		<a href='[% uri.entries(tags => [ tag.0 ]) %]'>[% tag.0 %]</a>
		&nbsp;
	</div>
	[% END %]
	</div>
	[% END %]

	<h2>entries</h2>
	<div class='rss'><a href='[% uri.entries(user => user, tags => tags, has_link => has_link, has_body => has_body, format => "rss" ) %]'>RSS</a> available
	for this query</div>
	<div class='entries'>
	[% IF entries.count %]
		[% WHILE (entry = entries.next) %]
		[% IF long_form %]
		[% PROCESS "entry_long.html" %]
		[% ELSE %]
		[% PROCESS "entry.html" %]
		[% END %]
		[% END %]
	[% ELSE %]
		<h3>no results for this query</h3>
	[% END %]
	</div>

	[% PROCESS "page_data.html" %]
